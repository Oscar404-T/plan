<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <title>Create Order</title>
  </head>
  <body>
    <h1>Create Order</h1>
    <form method="post" action="/ui/orders/create">
      {% if error %}<p style="color:red">{{ error }}</p>{% endif %}
      <label>Internal model: <input name="internal_model" type="text" required></label><br>
      <label>Length (mm): <input id="length" name="length" type="number" step="0.01" required></label><br>
      <label>Width (mm): <input id="width" name="width" type="number" step="0.01" required></label><br>
      <label>Size (inches): <input id="size" name="size" type="number" step="0.01" readonly></label><br>
      <label>Quantity: <input name="quantity" type="number" required></label><br>
      <label>Estimated yield (%): <input name="estimated_yield" type="number" step="0.01" min="0" max="100"></label><br>
      <label>Due datetime: <input name="due_datetime" type="datetime-local" required></label><br>

      <h3>Operations & per-operation capacity (pieces/hr) â€” leave blank to use defaults</h3>
      {% for op in operations %}
      <div>
        <label>{{ op.name }}: <input name="op_{{ op.id }}" type="number" placeholder="pieces/hr"></label>
      </div>
      {% endfor %}

      <button type="submit">Create Order</button>
    </form>

    <script>
      function computeSize(){
        const l = parseFloat(document.getElementById('length').value) || 0;
        const w = parseFloat(document.getElementById('width').value) || 0;
        const size = Math.sqrt(l*l + w*w) / 25.4;
        const out = Math.round(size * 100) / 100;
        document.getElementById('size').value = out.toFixed(2);
      }
      document.getElementById('length').addEventListener('input', computeSize);
      document.getElementById('width').addEventListener('input', computeSize);
      window.addEventListener('load', computeSize);
    </script>
  </body>
</html>
